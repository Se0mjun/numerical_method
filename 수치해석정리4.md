# 행렬 분해 방법 요약

## 목차
1. [소개](#소개)
2. [LU 분해 (LU Decomposition)](#1-lu-분해-lu-decomposition)
3. [QR 분해 (QR Decomposition)](#2-qr-분해-qr-decomposition)
4. [고유값 분해 (Eigendecomposition)](#3-고유값-분해-eigendecomposition)
5. [스펙트럼 분해 (Spectral Decomposition)](#4-스펙트럼-분해-spectral-decomposition)
6. [특이값 분해 (Singular Value Decomposition, SVD)](#5-특이값-분해-singular-value-decomposition-svd)
7. [조르단 분해 (Jordan Decomposition)](#6-조르단-분해-jordan-decomposition)
8. [연습문제](#7-연습문제)
9. [분해 방법의 비교 및 응용](#8-분해-방법의-비교-및-응용)

## 소개

행렬 분해(Matrix Decomposition)는 주어진 행렬을 여러 행렬의 곱으로 분해하는 것을 말합니다. 주요 목적은 행렬의 성질을 분석하고, 이를 이용하여 선형 시스템 해결, 최소 제곱 문제 해결, 고유값과 고유벡터 계산 등에 활용하는 것입니다. 행렬 분해는 데이터 분석, 기계 학습, 수치 선형대수학 등 다양한 분야에서 중요한 역할을 합니다.

행렬 분해(Matrix Decomposition)는 주어진 행렬을 여러 행렬의 곱으로 분해하는 것을 말합니다. 주요 목적은 행렬의 성질을 분석하고, 이를 이용하여 선형 시스템 해결, 최소 제곱 문제 해결, 고유값과 고유벡터 계산 등에 활용하는 것입니다. 행렬 분해는 데이터 분석, 기계 학습, 수치 선형대수학 등 다양한 분야에서 중요한 역할을 합니다.

## 1. LU 분해 (LU Decomposition)

LU 분해는 행렬을 하삼각행렬(Lower triangular matrix)과 상삼각행렬(Upper triangular matrix)의 곱으로 분해합니다.

$A = LU$

여기서:
- $L$은 하삼각행렬(lower triangular)
- $U$는 상삼각행렬(upper triangular)

### LDU 분해

LDU 분해는 LU 분해의 변형으로, 다음과 같이 표현됩니다:

$A = LDU$

여기서:
- $L$은 하삼각행렬
- $D$는 대각행렬
- $U$는 상삼각행렬

### 피벗팅(Pivoting)

부분 피벗팅(partial pivoting)을 이용한 LU 분해는 다음과 같습니다:

$PA = LU$

여기서 $P$는 순열 행렬(permutation matrix)로, $A$의 행을 재배열합니다.

전체 피벗팅(full pivoting)을 이용한 LU 분해는 다음과 같습니다:

$PAQ = LU$

여기서 $Q$는 $A$의 열을 재배열하는 순열 행렬입니다.

### 연립방정식 해결

$Ax = b$ 형태의 연립방정식이 주어졌을 때, LU 분해를 이용하여 해를 구하는 과정:
1. $A = LU$로 분해
2. $Ly = b$의 해 $y$를 구함
3. $Ux = y$의 해 $x$를 구함

## 2. QR 분해 (QR Decomposition)

QR 분해는 행렬을 직교행렬과 상삼각행렬의 곱으로 분해합니다.

$A = QR$

여기서:
- $Q$는 직교행렬(orthogonal matrix): $Q^TQ = QQ^T = I$
- $R$은 상삼각행렬(upper triangular matrix)

### 그람-슈미트 과정(Gram-Schmidt Process)

QR 분해는 그람-슈미트 과정을 통해 생성됩니다:

1. 벡터 투영 정의: $\text{proj}_u v = \frac{\langle u, v \rangle}{\langle u, u \rangle} u$
2. 그람-슈미트 과정:
   - $u_1 = a_1$
   - $u_2 = a_2 - \text{proj}_{u_1} a_2$
   - $u_3 = a_3 - \text{proj}_{u_1} a_3 - \text{proj}_{u_2} a_3$
   - ...
   - $u_n = a_n - \sum_{j=1}^{n-1} \text{proj}_{u_j} a_n$
3. 정규화: $q_i = \frac{u_i}{\|u_i\|}$

### QR 분해를 수행하는 다른 방법들

- 하우스홀더 반사(Householder reflections): 수치적으로 안정적인 방법
- 기븐스 회전(Givens rotations): 희소 행렬에 유용한 방법

### 연립방정식 해결

$Ax = b$ 형태의 연립방정식이 주어졌을 때, QR 분해를 이용하여 해를 구하는 과정:
1. $A = QR$로 분해
2. $Qy = b$의 해 $y = Q^Tb$를 구함
3. $Rx = y$의 해 $x$를 구함

## 3. 고유값 분해 (Eigendecomposition)

고유값 분해는 행렬을 고유벡터와 고유값을 이용하여 분해합니다.

$A = V\Delta V^{-1}$

여기서:
- $V$는 $A$의 고유벡터들을 열로 가진 행렬
- $\Delta$는 대응하는 고유값들을 대각 성분으로 가지는 대각 행렬

### 고유값과 고유벡터

$n \times n$ 정사각행렬 $A$에 대해, 스칼라 $\lambda$와 영벡터가 아닌 벡터 $v$가 $Av = \lambda v$를 만족할 때, $v$를 $A$의 고유벡터라 하고 $\lambda$를 해당 고유벡터에 대응하는 고유값이라 합니다.

다음 조건들은 동치입니다:
- $\lambda$가 $A$의 고유값이다.
- $A - \lambda I$가 특이(singular) 행렬이다.
- $\det(A - \lambda I) = 0$, 즉 $\lambda$가 특성다항식의 근이다.

### 대수적 중복도와 기하적 중복도

- 대수적 중복도(algebraic multiplicity): 특성 방정식의 해로서 특정 고유값이 나타나는 횟수
- 기하적 중복도(geometric multiplicity): 주어진 고유값에 대응하는 고유벡터가 생성하는 고유공간의 차원

행렬이 대각화 가능하기 위해서는 모든 고유값에 대해 대수적 중복도와 기하적 중복도가 같아야 합니다.

## 4. 스펙트럼 분해 (Spectral Decomposition)

실수 성분을 가진 대칭(symmetric) 행렬 $A$는 항상 실수 고유값과 직교 정규화된 실수 고유벡터를 가집니다. 이러한 행렬의 고유값 분해는 스펙트럼 분해라 부르며 다음과 같이 표현됩니다:

$A = Q\Delta Q^T$

여기서:
- $Q$는 직교 행렬: $QQ^T = Q^TQ = I$
- $\Delta$는 고유값들을 대각 성분으로 가지는 대각 행렬

대칭행렬의 스펙트럼 분해는 rank-one 행렬의 합으로도 표현할 수 있습니다:

$A = \lambda_1 q_1 q_1^T + \lambda_2 q_2 q_2^T + ... + \lambda_n q_n q_n^T$

여기서 $q_i$는 $Q$의 열 벡터이며 직교 정규 벡터입니다. 각 $q_i q_i^T$는 rank-one 행렬이자 투영 행렬(projection matrix)입니다.

## 5. 특이값 분해 (Singular Value Decomposition, SVD)

모든 $m \times n$ 행렬 $A$는 다음과 같이 특이값 분해가 가능합니다:

$A = U\Sigma V^T$

여기서:
- $U$는 $m \times m$ 직교 행렬
- $V$는 $n \times n$ 직교 행렬
- $\Sigma$는 $m \times n$ 직사각형 대각 행렬로, 대각 성분은 음수가 아닌 실수(특이값)입니다

### 특이값 분해의 특성

- 행렬 $A$의 계수(rank)는 0이 아닌 특이값의 개수와 같습니다
- 프로베니우스 노름(Frobenius norm): $\|A\|_F = \left(\sum_{i,j} |a_{ij}|^2\right)^{1/2} = \left(\sum_{i} \sigma_i^2\right)^{1/2}$
- 연산자 노름(Operator norm): $\|A\|_{op} = \max_{x\neq 0} \frac{\|Ax\|}{\|x\|} = \sigma_{max}$

### 특이값 분해의 계산

- $U$는 $AA^T$의 스펙트럼 분해에서 얻은 직교행렬
- $V$는 $A^TA$의 스펙트럼 분해에서 얻은 직교행렬
- $A$의 특이값은 $A^TA$와 $AA^T$의 고유값의 양의 제곱근

### 유사역(Pseudoinverse)

특이값 분해는 행렬의 유사역(pseudoinverse)을 계산하는 데 사용될 수 있습니다:

$A^† = V\Sigma^†U^T$

여기서 $\Sigma^†$는 $\Sigma$의 유사역으로, 모든 0이 아닌 대각 성분을 그것의 역수로 바꾸고 결과 행렬을 전치함으로써 형성됩니다.

### 투영 행렬(Projection Matrix)

만약 특이값 분해 $A = U\Sigma V^T$로 주어진 행렬 $A$의 열벡터공간으로 투영하는 투영 행렬(projection matrix) $A(A^TA)^{-1}A^T$은 다음과 같이 표현됩니다:

$A(A^TA)^{-1}A^T = U\Sigma V^T(V\Sigma^TU^TU\Sigma V^T)^{-1}V\Sigma^TU^T = UU^T$

## 6. 조르단 분해 (Jordan Decomposition)

모든 $n \times n$ 정사각행렬 $A$는 다음과 같이 조르단 분해가 가능합니다:

$A = VJV^{-1}$

여기서:
- $V$는 일반화된 고유벡터들을 열로 가진 행렬
- $J$는 조르단 표준형(Jordan normal form)으로, 블록 대각 행렬입니다

조르단 분해는 행렬이 대각화 불가능한 경우에도 항상 가능한 분해 방법입니다.

## 8. 분해 방법의 비교 및 응용

### 각 분해 방법의 장단점 비교

| 분해 방법 | 장점 | 단점 | 주요 응용 분야 |
|---------|-----|------|-------------|
| LU 분해 | - 구현이 간단하고 계산 효율적<br>- 연립방정식 해결에 효과적<br>- 행렬식 계산에 용이 | - 수치적 안정성 문제가 있을 수 있음<br>- 피봇팅 필요<br>- 직사각 행렬에는 바로 적용 어려움 | - 선형 방정식 시스템 해결<br>- 행렬식 계산<br>- 역행렬 계산 |
| QR 분해 | - 수치적으로 안정적<br>- 최소제곱법 문제에 효과적<br>- 직사각 행렬에도 적용 가능 | - LU 분해보다 계산량 많음<br>- 구현이 복잡함 | - 최소제곱법 문제<br>- QR 알고리즘(고유값 계산)<br>- 선형 종속성 판단 |
| 고유값 분해 | - 행렬의 대수적 성질 분석에 유용<br>- 행렬 거듭제곱 계산 효율적<br>- 선형 변환 시각화 | - 모든 행렬에 적용 불가<br>- 고유벡터가 직교하지 않을 수 있음 | - 주성분 분석(PCA)<br>- 마르코프 체인 분석<br>- 미분방정식 시스템 해결 |
| 스펙트럼 분해 | - 대칭행렬의 좋은 성질 활용<br>- 고유벡터가 직교<br>- 행렬 함수 계산 간편 | - 대칭행렬에만 적용 가능 | - 이차형식 최적화<br>- 공분산 행렬 분석<br>- 진동 모드 분석 |
| 특이값 분해 | - 모든 행렬에 적용 가능<br>- 수치적 안정성 우수<br>- 차원 축소에 효과적 | - 계산 비용이 높음<br>- 구현 복잡 | - 차원 축소(LSI, PCA)<br>- 이미지 압축<br>- 데이터 노이즈 제거<br>- 추천 시스템 |
| 조르단 분해 | - 모든 정사각행렬에 적용 가능<br>- 고유값 중복된 경우 분석 용이 | - 계산이 불안정<br>- 응용이 제한적 | - 미분방정식 시스템<br>- 행렬의 이론적 분석 |

### 기계학습과 데이터 과학에서의 응용

#### PCA(Principal Component Analysis)와 SVD의 관계
PCA는 데이터의 분산을 최대화하는 방향으로 차원을 축소하는 기법입니다. 이는 데이터 행렬 $X$의 공분산 행렬 $X^TX$의 고유값 분해를 통해 수행되지만, SVD를 통해서도 직접 계산할 수 있습니다. $X = U\Sigma V^T$일 때, $V$의 열은 PCA의 주성분 방향을 나타냅니다. 이러한 관계는 SVD가 대용량 데이터에서 PCA를 더 효율적으로 계산할 수 있게 해줍니다.

#### 추천 시스템과 잠재 의미 분석(LSI)
Netflix나 Amazon 같은 추천 시스템에서는 사용자-아이템 행렬을 SVD로 분해하여 잠재 요인(latent factors)을 추출합니다. 이 요인들은 사용자의 취향과 아이템의 특성을 나타내며, 이를 통해 사용자가 아직 평가하지 않은 아이템에 대한 선호도를 예측할 수 있습니다.

비슷하게, 정보 검색 분야의 잠재 의미 분석(LSI)은 단어-문서 행렬을 SVD로 분해하여 단어와 문서 간의 의미적 관계를 파악합니다.

### 컴퓨터 그래픽스와 이미지 처리

#### 이미지 압축
SVD는 이미지 압축에 활용될 수 있습니다. 이미지를 행렬로 표현했을 때, 가장 큰 특이값에 해당하는 특이벡터들만 선택하여 이미지를 근사할 수 있습니다. 이를 통해 원본 이미지의 주요 정보를 보존하면서 필요한 저장 공간을 크게 줄일 수 있습니다.

#### 컴퓨터 비전에서의 활용
QR 분해와 SVD는 카메라 캘리브레이션, 3D 재구성, 이미지 정합과 같은 컴퓨터 비전 알고리즘에서 중요한 역할을 합니다. 특히 SVD는 호모그래피 행렬이나 기초 행렬(fundamental matrix)을 추정하는 데 사용됩니다.

### 수치 안정성과 병렬 계산

현대 컴퓨팅에서는 행렬 분해 방법의 수치 안정성과 병렬화 가능성이 중요한 고려사항입니다. SVD와 QR 분해는 수치적으로 안정적인 반면, LU 분해는 피봇팅 없이 사용할 경우 불안정할 수 있습니다.

GPU나 분산 시스템에서는 각 분해 방법의 병렬화 가능성이 중요한데, QR 분해와 SVD는 병렬 계산에 적합한 알고리즘이 개발되어 있어 대규모 데이터 처리에 유리합니다.

### 행렬 분해의 미래

양자 컴퓨팅의 발전으로 행렬 분해 알고리즘의 혁신적인 속도 향상이 예상됩니다. 예를 들어, HHL 알고리즘은 특정 조건에서 선형 시스템 해결을 고전적 방법보다 지수적으로 빠르게 할 수 있습니다.

또한 희소 행렬과 초대형 행렬을 위한 근사 분해 방법들이 빅데이터와 딥러닝 시대에 더욱 중요해지고 있습니다. 랜덤화된 SVD, 스케치 기반 방법 등 새로운 알고리즘들이 개발되고 있습니다.